(window.webpackJsonpslack=window.webpackJsonpslack||[]).push([[0],{23:function(e,t,a){e.exports=a(59)},28:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(16),o=a.n(r),c=(a(28),a(17)),m=a(18),l=a(21),i=a(19),u=a(2),d=a(22),h=a(6),g=a(20),p=a(4),f=a.n(p),v=a(5),E=a.n(v);function b(e){e.preventDefault();var t=this.state,a=t.newMessage,s=t.currentUser,n=t.currentRoom;""!==a.trim()&&(s.sendMessage({text:a,roomId:"".concat(n.id)}),this.setState({newMessage:""}))}function N(){var e=this.state.showForm;this.setState({showForm:!e})}function w(){var e=this.state.showForm;this.setState({showDmList:!e}),console.log(this.ShowDmList)}function D(e){if(void 0===e.target)console.log(e),this.setState({userIds:e});else{var t=e.target,a=t.value,s=t.name;this.setState(Object(g.a)({},s,a))}}function I(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"afa1c12e-b196-4bb4-b940-a1af439328be",a=this.state.currentUser;return this.setState({messages:[],showForm:!1,showDmList:!1}),a.subscribeToRoom({roomId:"".concat(t),messageLimit:100,hooks:{onMessage:function(t){e.setState({messages:[].concat(Object(h.a)(e.state.messages),[t])})},onPresenceChanged:function(){var t=e.state.currentRoom;e.setState({roomUsers:t.users.sort(function(e){return"online"===e.presence.state?-1:1})})}}}).then(function(t){var s=t.customData&&t.customData.isDirectMessage?t.customData.userIds.filter(function(e){return e!==a.id})[0]:t.name;e.setState({currentRoom:t,roomUsers:t.users,rooms:a.rooms,roomName:s})}).catch(console.error)}function M(e){var t=this;e.preventDefault();var a=this.state.userId;null!==a&&""!==a.trim()?(this.setState({isLoading:!0}),E.a.post("http://localhost:5200/get_users").then(function(e){var a=e.data;t.setState({users:a})}),E.a.post("http://localhost:5200/users",{userId:a}).then(function(){var e=new f.a.TokenProvider({url:"http://localhost:5200/authenticate"});return new f.a.ChatManager({instanceLocator:"v1:us1:4811d398-69b5-472e-bfcf-e24d61e97f14",userId:a,tokenProvider:e}).connect({onAddedToRoom:function(e){var a=t.state.rooms;t.setState({rooms:[].concat(Object(h.a)(a),[e])})}}).then(function(e){t.setState({currentUser:e,showLogin:!1,isLoading:!1,rooms:e.rooms},function(){return I.call(t)})})}).catch(console.error)):alert("Invalid userId")}function S(e){var t=this.state,a=t.currentUser,s=t.rooms,n="".concat(a.id,"_").concat(e),r=s.filter(function(t){if(t.customData&&t.customData.isDirectMessage){var s=[a.id,e],n=t.customData.userIds;if(s.sort().join("")===n.sort().join(""))return{room:t}}return!1});return r.length>0?Promise.resolve(r[0]):a.createRoom({name:"".concat(n),private:!0,addUserIds:["".concat(e)],customData:{isDirectMessage:!0,userIds:[a.id,e]}})}function U(){var e=this.state.channelName,t=this.state.userIds,a=this.state,s=a.currentUser,n=a.rooms,r="".concat(e),o=n.filter(function(e){if(e.customData&&e.customData.isDirectMessage){var a=t.concat(s.id),n=e.customData.userIds;if(a.sort().join("")===n.sort().join(""))return{room:e}}return!1});return o.length>0?Promise.resolve(o[0]):s.createRoom({name:r,private:!0,addUserIds:t})}function k(e){var t=this;S.call(this,e).then(function(e){I.call(t,e.id)})}function j(){var e=this;U.call(this).then(function(t){I.call(e,t.id)})}var L=function(e){var t=e.userId,a=e.handleInput,s=e.connectToChatkit;return n.a.createElement("div",{className:"dialog-container"},n.a.createElement("div",{className:"dialog"},n.a.createElement("form",{className:"dialog-form",onSubmit:s},n.a.createElement("label",{className:"username-label",htmlFor:"username"},"Login with your username"),n.a.createElement("input",{id:"username",className:"username-input",autoFocus:!0,type:"text",name:"userId",value:t,onChange:a,placeholder:"Enter your username"}),n.a.createElement("button",{type:"submit",className:"submit-btn"},"Submit"))))},C=a(3),O=a.n(C),y=function(e){var t=e.sendGroupMessage,a=e.users,s=e.handleInput,r=e.channelName,o=e.userIds,c=e.toggleShow,m=a.map(function(e){return{name:e.id,value:e.id}});return n.a.createElement("section",{className:"chat-screen"},n.a.createElement("label",{className:"username-label",htmlFor:"username"},"Group Channel Name"),n.a.createElement("input",{id:"name",autoFocus:!0,type:"text",name:"channelName",value:r,onChange:s,placeholder:"Enter your username"}),n.a.createElement("div",{className:"custom-select"},n.a.createElement(O.a,{options:m,name:"userIds",value:o,onSelectOptions:s})),o.length>0?n.a.createElement("button",{type:"submit",className:"submit-btn",onClick:function(){return t()}},"Submit"):null,n.a.createElement("button",{onClick:function(){return c()}},"Cancel"))},R=function(e){var t=e.sendGroupMessage,a=e.users,s=(e.handleInput,e.dmUser,e.currentUser),r=a.map(function(e){return n.a.createElement("li",{className:"room-member",key:e.name},n.a.createElement("div",null,n.a.createElement("span",null,e.name)),s.id!==e.id?n.a.createElement("button",{onClick:function(){return t(e.id)},title:"Send ".concat(e.name," a direct message"),className:"send-dm"},"+"):null)});return n.a.createElement("div",{className:"room-users"},n.a.createElement("ul",null,r))},T=function(e){var t=e.rooms,a=e.currentRoom,s=e.connectToRoom,r=e.currentUser,o=e.sendDM,c=e.sendGroupMessage,m=e.users,l=e.handleInput,i=e.channelName,u=e.toggleShow,d=e.showForm,h=e.userIds,g=e.dmUser,p=e.showDmList,f=e.toggleShowDmList,v=[],E=[];return t.forEach(function(e){var t=e.isPrivate?"":"#",o=e.id===a.id?"active":"",c=n.a.createElement("li",{className:o,key:e.id,onClick:function(){return s(e.id)}},n.a.createElement("span",{className:"room-icon"},t),e.customData&&e.customData.isDirectMessage?n.a.createElement("span",{className:"room-name"},e.customData.userIds.filter(function(e){return e!==r.id})[0]):n.a.createElement("span",{className:"room-name"},e.name));e.customData&&e.customData.isDirectMessage?E.push(c):v.push(c)}),n.a.createElement("div",{className:"rooms"},n.a.createElement("div",{className:"section"},n.a.createElement("div",null,"Groups",n.a.createElement("span",{className:"create-conv"},n.a.createElement("a",{onClick:function(){return u()}},"Add")),d?n.a.createElement(y,{sendGroupMessage:c,users:m,handleInput:l,channelName:i,userIds:h,showDmList:p,toggleShow:u}):null),n.a.createElement("ul",{className:"chat-rooms"},v)),n.a.createElement("div",{className:"section"},n.a.createElement("div",null,"Private Chats",n.a.createElement("span",{className:"create-conv"},n.a.createElement("a",{onClick:function(){return f()}},"Add")),p?n.a.createElement(R,{sendGroupMessage:o,users:m,handleInput:l,dmUser:g,currentUser:r}):null),n.a.createElement("ul",{className:"chat-rooms"},E)))},F=a(61),G=function(e){return e.messages.map(function(e){var t=Object(F.a)(new Date("".concat(e.updatedAt)),"HH:mm");return n.a.createElement("li",{className:"message",key:e.id},n.a.createElement("div",null,n.a.createElement("span",{className:"user-id"},e.senderId),n.a.createElement("span",null,e.text)),n.a.createElement("span",{className:"message-time"},t))})},P=function(e){var t=e.roomUsers,a=e.sendDM,s=e.currentUser,r=t.map(function(e){return n.a.createElement("li",{className:"room-member",key:e.id},n.a.createElement("div",null,n.a.createElement("span",{className:"presence ".concat(e.presence.state)}),n.a.createElement("span",null,e.name)),s.id!==e.id?n.a.createElement("button",{onClick:function(){return a(e.id)},title:"Send ".concat(e.name," a direct message"),className:"send-dm"},"+"):null)});return n.a.createElement("div",{className:"room-users"},n.a.createElement("ul",null,r))},x=(a(56),a(57),a(58),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(i.a)(t).call(this))).state={userId:"",users:[],showLogin:!0,isLoading:!1,currentUser:null,currentRoom:null,rooms:[],roomUsers:[],roomName:null,messages:[],newMessage:"",channelName:"",showForm:!1,userIds:[],dmUser:"",showDmList:!1},e.handleInput=D.bind(Object(u.a)(e)),e.connectToChatkit=M.bind(Object(u.a)(e)),e.connectToRoom=I.bind(Object(u.a)(e)),e.sendMessage=b.bind(Object(u.a)(e)),e.sendDM=k.bind(Object(u.a)(e)),e.sendGroupMessage=j.bind(Object(u.a)(e)),e.toggleShow=N.bind(Object(u.a)(e)),e.toggleShowDmList=w.bind(Object(u.a)(e)),e}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.state,t=e.userId,a=e.users,s=e.showLogin,r=e.rooms,o=e.currentRoom,c=e.currentUser,m=e.messages,l=e.newMessage,i=e.roomUsers,u=e.roomName,d=e.channelName,h=e.showForm,g=e.userIds,p=e.dmUser,f=e.showDmList;return n.a.createElement("div",{className:"App"},n.a.createElement("aside",{className:"sidebar left-sidebar"},c?n.a.createElement("div",{className:"user-profile"},n.a.createElement("span",{className:"username"},c.name),n.a.createElement("span",{className:"user-id"},"@".concat(c.id))):null,o?n.a.createElement(T,{rooms:r,currentRoom:o,connectToRoom:this.connectToRoom,currentUser:c,sendGroupMessage:this.sendGroupMessage,sendDM:this.sendDM,users:a,handleInput:this.handleInput,channelName:d,toggleShow:this.toggleShow,showForm:h,userIds:g,dmUser:p,showDmList:f,toggleShowDmList:this.toggleShowDmList}):null),n.a.createElement("section",{className:"chat-screen"},n.a.createElement("header",{className:"chat-header"},o?n.a.createElement("h3",null,u):null),n.a.createElement("ul",{className:"chat-messages"},n.a.createElement(G,{messages:m})),n.a.createElement("footer",{className:"chat-footer"},n.a.createElement("form",{onSubmit:this.sendMessage,className:"message-form"},n.a.createElement("input",{type:"text",value:l,name:"newMessage",className:"message-input",placeholder:"Type your message and hit ENTER to send",onChange:this.handleInput})))),n.a.createElement("aside",{className:"sidebar right-sidebar"},o?n.a.createElement(P,{currentUser:c,sendDM:this.sendDM,roomUsers:i}):null),s?n.a.createElement(L,{userId:t,handleInput:this.handleInput,connectToChatkit:this.connectToChatkit}):null)}}]),t}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[23,1,2]]]);
//# sourceMappingURL=main.f0a244a4.chunk.js.map